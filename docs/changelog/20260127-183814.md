# 视频帧提取性能优化

## 任务描述
优化视频分析时的帧提取效率，将多次 ffmpeg 进程调用改为一次性提取。

## 待办事项
- [x] 分析现有帧提取实现
- [x] 设计一次性提取方案
- [x] 实现 select 滤镜方案
- [x] 添加分辨率缩放优化

## 执行结果

### 修改文件
- `src/main/services/analyzer.ts`

### 变更内容
1. **移除循环调用**：原实现为每帧启动一次 ffmpeg 进程（N次进程启动）
2. **一次性提取**：使用 ffmpeg select 滤镜在单次进程中提取所有帧
3. **分辨率优化**：添加 `scale=640:-1` 减小输出图像大小

### 技术细节
```bash
ffmpeg -i video.mp4 -vf "select='between(t,X1,Y1)+between(t,X2,Y2)+...',scale=640:-1" -vsync vfr frame_%d.jpg
```

- `between(t,X,Y)` - 按时间选择帧（保持原有时间戳逻辑）
- `scale=640:-1` - 宽度640像素，高度自适应
- `-vsync vfr` - 可变帧率输出，仅输出选中的帧
- `-q:v 2` - JPEG质量设置

### 性能提升
- 进程启动开销：N次 → 1次
- 减少磁盘I/O抖动
- 更小的输出图像体积
